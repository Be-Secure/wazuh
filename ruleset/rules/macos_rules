<group name="macOS,">

  <rule id="110001" level="5">
    <decoded_as>macOS_tccd</decoded_as>
    <match type="pcre2">(?i)update access record.+allowed</match>
    <description>$(application) has been granted permission to $(service) at $(time)</description>
  </rule>

  <rule id="110002" level="5">
    <decoded_as>macOS_tccd</decoded_as>
    <match type="pcre2">(?i)update access record.+denied</match>
    <description>$(application) has been denied permission to $(service) at $(time)</description>
  </rule>
  
  <rule id="110003" level="5">
    <decoded_as>macOS_loginwindow</decoded_as>
    <regex type="pcre2">sendBSDNotification: \w+.\w+.\w+.screenIsUnlocked</regex>
    <description>Screen Unlocked with UserID:$(userID)</description>
    <mitre>
      <id>T1078</id>
    </mitre>
    <group>authentication_success,gdpr_IV_32.2,gpg13_7.1,gpg13_7.2,hipaa_164.312.b,nist_800_53_AC.7,nist_800_53_AU.14,pci_dss_10.2.5,tsc_CC6.8,tsc_CC7.2,tsc_CC7.3,</group>
  </rule>
  
  <rule id="110004" level="5">
    <decoded_as>macOS_loginwindow</decoded_as>
    <match>screenIsLocked</match>
    <description>Screen locked for UserID:$(userID)</description>
    <mitre>
      <id>T1078</id>
    </mitre>
    <group>authentication_success,gdpr_IV_32.2,gpg13_7.1,gpg13_7.2,hipaa_164.312.b,nist_800_53_AC.7,nist_800_53_AU.14,pci_dss_10.2.5,tsc_CC6.8,tsc_CC7.2,tsc_CC7.3,</group>
  </rule>
  
  <rule id="110005" level="5">
    <decoded_as>macOS_loginwindow</decoded_as>
    <match>logoutNoReturn</match>
    <description>User LogOff</description>
    <mitre>
      <id>T1078</id>
    </mitre>
    <group>authentication_success,gdpr_IV_32.2,gpg13_7.1,gpg13_7.2,hipaa_164.312.b,nist_800_53_AC.7,nist_800_53_AU.14,pci_dss_10.2.5,tsc_CC6.8,tsc_CC7.2,tsc_CC7.3,</group>
  </rule>
  
  <rule id="110006" level="5">
    <decoded_as>macOS_loginwindow</decoded_as>
    <match>loginIsComplete</match>
    <description>User Login</description>
    <mitre>
      <id>T1078</id>
    </mitre>
    <group>authentication_success,gdpr_IV_32.2,gpg13_7.1,gpg13_7.2,hipaa_164.312.b,nist_800_53_AC.7,nist_800_53_AU.14,pci_dss_10.2.5,tsc_CC6.8,tsc_CC7.2,tsc_CC7.3,</group>
  </rule>
  
  <rule id="110007" level="5">
    <decoded_as>macOS_screensharingd</decoded_as>
    <match type="pcre2">(?i)authentication.+failed</match>
    <description>Attempt to connect to screen sharing with username $(dstuser) from $(ip_address) failed</description>
    <mitre>
      <id>T1021</id>
    </mitre>
  </rule>

  <rule id="110008" level="5">
    <decoded_as>macOS_screensharingd</decoded_as>
    <match type="pcre2">(?i)authentication.+succeeded</match>
    <description>Attempt to connect to screen sharing with username $(dstuser) from $(ip_address) succeeded</description>
    <mitre>
      <id>T1078</id>
    </mitre>
    <group>authentication_success,gdpr_IV_32.2,gpg13_7.1,gpg13_7.2,hipaa_164.312.b,nist_800_53_AC.7,nist_800_53_AU.14,pci_dss_10.2.5,tsc_CC6.8,tsc_CC7.2,tsc_CC7.3,</group>
  </rule>
  
  <rule id="110009" level="5">
    <decoded_as>macOS_securityd_process</decoded_as>
    <match type="pcre2">(?i)session.+created</match>
    <description>Session $(sessionId) has been created</description>
  </rule>

  <rule id="110010" level="5">
    <decoded_as>macOS_securityd_process</decoded_as>
    <match type="pcre2">(?i)session.+destroyed</match>
    <description>Session $(sessionId) has been destroyed</description>
  </rule>

</group>
